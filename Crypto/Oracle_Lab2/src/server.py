from Crypto.Util.number import bytes_to_long
from flag import flag

banner = """
 __       __            __                                                      __                      
|  \  _  |  \          |  \                                                    |  \                     
| $$ / \ | $$  ______  | $$  _______   ______   ______ ____    ______         _| $$_     ______         
| $$/  $\| $$ /      \ | $$ /       \ /      \ |      \    \  /      \       |   $$ \   /      \        
| $$  $$$\ $$|  $$$$$$\| $$|  $$$$$$$|  $$$$$$\| $$$$$$\$$$$\|  $$$$$$\       \$$$$$$  |  $$$$$$\       
| $$ $$\$$\$$| $$    $$| $$| $$      | $$  | $$| $$ | $$ | $$| $$    $$        | $$ __ | $$  | $$       
| $$$$  \$$$$| $$$$$$$$| $$| $$_____ | $$__/ $$| $$ | $$ | $$| $$$$$$$$        | $$|  \| $$__/ $$       
| $$$    \$$$ \$$     \| $$ \$$     \ \$$    $$| $$ | $$ | $$ \$$     \         \$$  $$ \$$    $$       
 \$$      \$$  \$$$$$$$ \$$  \$$$$$$$  \$$$$$$  \$$  \$$  \$$  \$$$$$$$          \$$$$   \$$$$$$        
                                                                                                        
                                                                                                        
                                                                                                        
  ______                                __                  __                 __               ______  
 /      \                              |  \                |  \               |  \             /      \ 
|  $$$$$$\  ______   ______    _______ | $$  ______        | $$       ______  | $$____        |  $$$$$$\
| $$  | $$ /      \ |      \  /       \| $$ /      \       | $$      |      \ | $$    \        \$$__| $$
| $$  | $$|  $$$$$$\ \$$$$$$\|  $$$$$$$| $$|  $$$$$$\      | $$       \$$$$$$\| $$$$$$$\       /      $$
| $$  | $$| $$   \$$/      $$| $$      | $$| $$    $$      | $$      /      $$| $$  | $$      |  $$$$$$ 
| $$__/ $$| $$     |  $$$$$$$| $$_____ | $$| $$$$$$$$      | $$_____|  $$$$$$$| $$__/ $$      | $$_____ 
 \$$    $$| $$      \$$    $$ \$$     \| $$ \$$     \      | $$     \\$$    $$| $$    $$      | $$     \
  \$$$$$$  \$$       \$$$$$$$  \$$$$$$$ \$$  \$$$$$$$       \$$$$$$$$ \$$$$$$$ \$$$$$$$        \$$$$$$$$
                                                                                                                                                                                                             
"""

helper = "Did you know Diffie-Hellman?\n"

# p is a prime generate by handmade program
p = 0x0a38522d6c0b9a056801aa0cbe0329ce8457e9724acd1323f19ea310700d6e38e0252e2eb5b2ba4846259c99e0006441199cf10053471486058a4caa04156a504b
g = 0x2
secret = bytes_to_long(flag)
while True:
    try:
        s = input(helper)
        a = int(s)
        print(pow(a, secret, p))
    except:
        print("What's your mean by {}?".format(s))
        exit()
